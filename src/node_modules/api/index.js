import axios from "axios";

const instance = axios.create({
    withCredentials: true,
    baseURL: 'https://social-network.samuraijs.com/api/1.0',
    headers: {"API-KEY": "a7c93688-0da8-451c-b46d-c0679e307194"} // Homer
    //  headers: {"API-KEY": "8f5b7c2e-b3e2-44a2-aea0-b69547f2ca55"} // Burns
})

export const fetchUsersApi = (currentPage, pageSize, searchText, searchSelect) => {
    return instance.get(`/users?page=${currentPage}&count=${pageSize}&term=${searchText}&friend=${searchSelect}`).then(res => res.data)
}

export const followApi = (userId) => {
    return instance.post(`/follow/${userId}`, {}).then(res => res.data)
}

export const unFollowApi = (userId) => {
    return instance.delete(`/follow/${userId}`).then(res => res.data)
}

export const loginApi = (options = {}) => {
    return instance.post('/auth/login', options).then(res => res.data)
}

export const logoutApi = () => {
    return instance.delete(`auth/login`).then(res => res.data)
}

export const getProfileApi = (recipientId) => {
    return instance.get(`profile/${recipientId}`).then(res => res.data)
}

export const getStatusApi = (userId) => {
    return instance.get(`/profile/status/${userId}`).then(res => res.data)
}

export const putStatusApi = (options = {}) => {
    return instance.put('/profile/status', options).then(res => res.data)
}

export const putProfileApi = (options = {}) => {
    return instance.put('/profile', options).then(res => res.data)
}

export const putProfileImage = (imageFile) => {
    const formData = new FormData()
    formData.append("image", imageFile)
    return instance.put('/profile/photo', formData, {
        headers: {
            'Content-Type': 'multipart/form-data'
        }
    }).then(res => res.data)
}

export const getAllDialogsApi = () => {
    return instance.get('/dialogs').then(res => res.data)
}

export const dialogWithUser = (recipientId, currentPage, pageSize) => {
    return instance.get(`/dialogs/${recipientId}/messages?page=${currentPage}&count=${pageSize}`).then(res => res.data)
}

export const postMessageApi = (recipientId, options = {}) => {
    return instance.post(`dialogs/${recipientId}/messages`, options).then(res => res.data)
}

export const getNewMessagesCount = () => {
    return instance.get('dialogs/messages/new/count').then(res => res.data)
}

export const deleteMessage = (messageId) => {
    return instance.delete(`/dialogs/messages/${messageId}`).then(res => res.data)
}

export const getAllTodoList = () => {
    return instance.get('/todo-lists').then(res => res.data)
}

export const postNewTodoItem = (options = {}) => {
    return instance.post('/todo-lists', options).then(res => res.data)
}

export const deleteTodoItem = (todoItemId) => {
    return instance.delete(`/todo-lists/${todoItemId}`).then(res => res.data)
}

export const updateTodoItem = (todoItemId, options) => {
    return instance.put(`/todo-lists/${todoItemId}`, options).then(res => res.data)
}

export const getWeather = (city) => {
    return axios.get(`https://api.openweathermap.org/data/2.5/weather?q=${city}&units=metric&lang=ru&appid=e25ca3e12aa4d0df30512857462e4ecb`).then(res => res.data)
}

export const fetchCurrencies = () => {
    return axios.get('https://www.cbr-xml-daily.ru/daily_json.js').then(res => res.data)
}

export const getNews = (category = '') => {
    return axios.get(`https://newsapi.org/v2/top-headlines?country=ru&category=${category}&apiKey=9b56b07b59fb411aa20f516391c5c3ce`).then(res => res.data)
}

