import React, {useEffect, useState} from 'react'
import {getWeather} from "api";
import {Link} from "react-router-dom";

const Weather = () => {
    const [data, setData] = useState({})
    const [desc, setDesc] = useState('')
    const [weatherIconName, setWeatherIconName] = useState(null)

    useEffect(async () => {
        const data = await getWeather(`Москва`)
        // console.log('data weather', data)
        setData(data)
        setDesc(data.weather[0].description)
        setWeatherIconName(data.weather[0].icon)
    }, [])

    return (
        <>
            {weatherIconName !== null &&
            <Link
                to={`/weather/${data.name}`}
                className="nav-link link-secondary"
                style={{padding: '0px'}}
            >
                <div style={{backgroundImage: `url(http://openweathermap.org/img/wn/${weatherIconName}@2x.png)`}}>
                    <p style={{marginBottom: '0px'}}><b>{data.name}</b></p>
                    <span>{data.main.temp > 0 ? '+' : '-'}{data.main.temp.toFixed(1)}</span>
                    <br/>
                    <small>{desc}</small>
                </div>
            </Link>
            }
        </>
    )
}

export default Weather